# Chapter 2: 多电平信令 (例如 PAM-4)


欢迎来到 `Serializer_Deserializer_Component_Design` 项目教程的第二章！在上一章 [串行器/解串器 (SerDes)](01_串行器_解串器__serdes__.md) 中，我们了解了 SerDes 如何通过将并行数据转换为串行数据来解决高速传输中的布线和同步难题。然而，随着我们对数据传输速率的要求越来越高，仅仅依靠传统的二进制信号传输方式，SerDes 也开始面临新的挑战。本章，我们将探讨一种先进的技术——多电平信令，特别是 PAM-4，看看它是如何帮助 SerDes 实现更高传输效率的。

## 挑战：如何在有限的时间内传输更多数据？

想象一下，上一章我们提到的高速公路，即使我们把多条普通车道合并成了一条高速单行道（串行传输），如果车流量（数据量）持续暴增，这条单行道迟早也会不堪重负。我们当然可以尝试提高车速（信号频率），但正如高速行驶的赛车更容易失控一样，超高频率的信号在传输过程中也更容易受到干扰和损耗，导致数据出错。

那么，有没有办法让每一辆通过“收费站”（一个信号周期）的“车”携带更多的“乘客”（信息）呢？这就是多电平信令要解决的问题。

## 什么是多电平信令？—— 从单人自行车到多人巴士

在传统的数字通信中，我们通常使用**二进制信令**。这意味着在一个给定的时间点（一个“信号符号”），信号只有两种状态，比如高电平和低电平，分别代表数字世界的 ‘1’ 和 ‘0’。这就像一条单行道上，一次只能通过一辆代表 ‘0’ 的自行车或者一辆代表 ‘1’ 的自行车。

**多电平信令 (Multi-Level Signaling, MLS)** 则是一种更高级的技术。它允许一个信号符号携带多个比特的信息。怎么做到的呢？通过定义更多的信号状态（例如，更多的电压等级）。

继续用交通工具打比方：
*   **二进制信令 (例如 NRZ - Non-Return-to-Zero)**：就像我们有两种类型的车，一种车身涂着 "0"，另一种涂着 "1"。在一个信号周期内，我们发送一辆车，它要么是 "0" 车，要么是 "1" 车。所以一个信号周期（一个符号）传递 1 比特信息。
*   **多电平信令 (例如 PAM-4)**：现在想象我们有四种类型的车，分别涂着 "00"、"01"、"10"、"11"。在一个信号周期内，我们发送这四种车中的一种。这样，一个信号周期（一个符号）就能传递 2 比特信息！

通过这种方式，即使“车流速度”（信号符号速率，也叫波特率）不变，我们也能在相同时间内运送更多的“乘客”（数据比特）。

## 深入 PAM-4：四电平脉冲幅度调制

PAM-4 是目前非常流行的一种多电平信令技术。“PAM”是“脉冲幅度调制 (Pulse Amplitude Modulation)”的缩写，意味着我们通过改变脉冲信号的“幅度”（通常是电压高低）来编码信息。“4”则表示有四种不同的幅度等级。

具体来说，PAM-4 使用四个不同的电压等级来表示两位的二进制数据组合：
*   电平 0：代表比特 `00`
*   电平 1：代表比特 `01`
*   电平 2：代表比特 `10`
*   电平 3：代表比特 `11`

我们可以用一个简单的图来直观地比较二进制信令 (这里用 PAM-2，即两电平脉冲幅度调制，与 NRZ 类似) 和 PAM-4：

```mermaid
graph LR
    subgraph 二进制信令 (PAM-2 / NRZ)
        V_High_NRZ["高电平 (+V)"] ---|"1"| Bit1_NRZ[比特 '1']
        V_Low_NRZ["低电平 (-V 或 0V)"] ---|"0"| Bit0_NRZ[比特 '0']
    end
    subgraph PAM-4 (四电平)
        Level3["电平 3 (+V)"] ---|"11"| Bits11_PAM4[比特 '11']
        Level2["电平 2 (+V/3)"] ---|"10"| Bits10_PAM4[比特 '10']
        Level1["电平 1 (-V/3)"] ---|"01"| Bits01_PAM4[比特 '01']
        Level0["电平 0 (-V)"] ---|"00"| Bits00_PAM4[比特 '00']
    end
```

在 PAM-4 信号中，每个信号单元（符号）不再仅仅是高或低两种状态，而是有四个清晰定义的电压台阶。

### PAM-4 的眼图

在[串行器/解串器 (SerDes)](01_串行器_解串器__serdes__.md)章节中我们提到，工程师常使用“眼图”来评估信号质量。对于 PAM-4 信号，由于它有四个电平，它的眼图会呈现出三个“眼睛”（上下两个电平之间形成一个眼，中间两个电平之间形成一个眼，最下面两个电平之间又形成一个眼）。

您可以参考 `Serializer_Deserializer_Component_Design.pdf` 文档中的图 3.1 (第 32 页)，它清晰地展示了 PAM-2 (二进制) 和 PAM-4 的信号波形以及它们各自的眼图。你会看到 PAM-4 的眼图比 PAM-2 的要复杂，眼睛也更“窄”一些，这意味着对噪声和时序的要求更高。

## PAM-4 的主要优势

采用 PAM-4 这样的多电平信令技术，主要能带来两大好处：

### 优势 1：在相同的符号率下，数据吞吐量翻倍

*   **符号率 (Symbol Rate / Baud Rate)**：指的是信号每秒钟变化的次数。可以理解为公路上每秒钟通过的车辆数量。
*   **比特率 (Bit Rate)**：指的是每秒钟实际传输的数据比特数量。可以理解为公路上每秒钟运送的总乘客数量。

对于传统的二进制信令 (NRZ/PAM-2)，每个符号只携带 1 比特信息。所以，比特率 = 符号率。例如，符号率为 1 GigaBaud (GBd)，比特率就是 1 Gigabit/second (Gbps)。

对于 PAM-4，每个符号携带 2 比特信息。所以，比特率 = 2 × 符号率。例如，符号率同样为 1 GBd，比特率就能达到 2 Gbps！

这意味着，在不提高信号“切换速度”的情况下，我们就能把数据传输能力提升一倍。

### 优势 2：在相同的数据吞吐量下，降低信号工作频率

反过来想，如果我们希望达到的数据吞吐量是固定的，比如 2 Gbps：
*   使用二进制信令，信号的符号率需要达到 2 GBd，这意味着信号需要在 2 GHz 的频率下工作。
*   使用 PAM-4，信号的符号率只需要达到 1 GBd，这意味着信号只需要在 1 GHz 的频率下工作。

**为什么要降低工作频率呢？**
因为信号频率越高，在电缆或电路板走线中传输时，信号的衰减和失真就越严重（这被称为“高频损耗”）。想象一下，你要在很远的地方听声音，低沉的鼓声（低频）比尖锐的哨声（高频）更容易传过去。降低信号的工作频率有助于克服这些高频损耗问题，从而在相同的物理链路上实现更可靠的高速数据传输。

`Serializer_Deserializer_Component_Design.pdf` 文档的图 3.2 (第 32 页) 就展示了在常用的 FR-4 电路板材料上，使用 PAM-4（工作在较低频率）相比于 NRZ（工作在较高频率）可以显著减少传输损耗。

## PAM-4 是如何工作的？（简化概念）

让我们简单了解一下 PAM-4 在 SerDes 系统中是如何运作的：

```mermaid
graph TD
    subgraph 发送端 (Transmitter)
        Binary_Input["原始二进制比特流 (例如: 01101100)"] --> Grouping["两位一组 (01, 10, 11, 00)"]
        Grouping --> PAM4_Encoder["PAM-4 编码器: 将比特对映射到电压电平"]
        PAM4_Encoder --> Signal_Levels["输出 PAM-4 模拟信号 (电平1, 电平2, 电平3, 电平0)"]
    end
    Signal_Levels --> Channel["传输通道 (电缆, PCB走线等)"]
    Channel --> Receiver_Input["接收到的可能带有噪声和衰减的 PAM-4 信号"]
    subgraph 接收端 (Receiver)
        Receiver_Input --> Sampling["采样与判决 (ADC + 比较器)"]
        Sampling --> PAM4_Decoder["PAM-4 解码器: 将判决后的电平映射回比特对"]
        PAM4_Decoder --> Binary_Output["恢复的二进制比特流 (希望是: 01101100)"]
    end
```

**在发送端 (Serializer 内部)：**
1.  输入的并行数据首先被转换成串行比特流。
2.  这个串行比特流被两位两位地分组。例如，如果比特流是 `01101100`，它会被分成 `01`, `10`, `11`, `00`。
3.  PAM-4 编码器会根据预设的映射规则（比如上面提到的 `00`→电平0, `01`→电平1, `10`→电平2, `11`→电平3），将每一对比特转换成一个特定的电压电平。
4.  驱动器将这些 последовательные电压电平发送到传输通道上。

**在接收端 (Deserializer 内部)：**
1.  接收器接收到经过传输通道的 PAM-4 信号。这个信号可能因为噪声和衰减而不再是完美的四个电平。
2.  关键的一步是**采样和判决**。接收器需要在精确的时刻对信号进行采样，然后判断采样到的电压值最接近四个理想电平中的哪一个。这通常需要一个快速的模数转换器 (ADC) 和比较逻辑。
3.  PAM-4 解码器根据判决结果，将识别出的电平再转换回对应的两位比特。
4.  这些恢复出来的比特对被重新组合成串行比特流，并最终转换回并行数据。

## PAM-4 的挑战

虽然 PAM-4 带来了显著的性能提升，但它也并非没有代价：

1.  **更小的电平间隔 (Reduced Voltage Margin)**：想象一下，在相同的总电压摆幅内（比如 -1V 到 +1V），二进制只需要区分两个电平，而 PAM-4 需要区分四个。这意味着相邻电平之间的电压差变小了。这就好比以前在两个大篮筐里投球，现在要在四个紧挨着的小篮筐里投球，难度自然增加了。更小的电平间隔使得信号对噪声更加敏感。微小的噪声就可能导致接收器错误地判决当前信号属于哪个电平。
2.  **接收端设计更复杂**：接收器需要更精确的电路（例如高精度的 ADC 和判决电路）来区分这四个靠得很近的电平。
3.  **对时钟恢复要求更高**：在正确的时间点采样信号对于 PAM-4 至关重要。如果采样时刻稍微偏离了符号的中心（“眼睛”的中心），就很容易采样到正在跳变的信号边缘，或者错误地判断电平。因此，PAM-4 对[时钟数据恢复 (CDR)](03_时钟数据恢复__cdr__.md) 电路的性能提出了更高的要求。我们将在下一章详细讨论 CDR。

## 总结

在本章中，我们学习了多电平信令，特别是 PAM-4 技术：

*   多电平信令允许一个信号符号携带多个比特的信息，从而提高数据传输效率。
*   PAM-4 使用四个不同的电压电平，每个电平代表两位二进制数据。
*   PAM-4 的主要优势包括：在相同符号率下将比特率翻倍，或者在相同比特率下将工作频率减半以克服高频损耗。
*   PAM-4 的实现依赖于发送端的精确编码和接收端的精确采样与判决。
*   PAM-4 也带来了挑战，如更小的噪声容限和对接收器及 CDR 电路更高的设计要求。

理解了 PAM-4 如何帮助我们“塞进”更多数据后，我们自然会想到，接收端是如何精确地从这种复杂信号中提取时钟并正确判决数据的呢？这正是我们下一章 [时钟数据恢复 (CDR)](03_时钟数据恢复__cdr__.md) 将要探讨的内容。敬请期待！

---

Generated by [AI Codebase Knowledge Builder](https://github.com/The-Pocket/Tutorial-Codebase-Knowledge)